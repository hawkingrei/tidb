# TestRangeColumnPartitionPruningForIn
set tidb_cost_model_version=2;
drop database if exists test_range_col_in;
create database test_range_col_in;
use test_range_col_in;
set @@session.tidb_partition_prune_mode='static';
CREATE TABLE t1 (
		id bigint(20)  NOT NULL AUTO_INCREMENT,
		dt date,
		PRIMARY KEY (id,dt) NONCLUSTERED)
		PARTITION BY RANGE COLUMNS(dt) (
		PARTITION p20201125 VALUES LESS THAN ("20201126"),
		PARTITION p20201126 VALUES LESS THAN ("20201127"),
		PARTITION p20201127 VALUES LESS THAN ("20201128"),
		PARTITION p20201128 VALUES LESS THAN ("20201129"),
		PARTITION p20201129 VALUES LESS THAN ("20201130"));
explain format='brief' select /*+ HASH_AGG() */ count(1) from t1 where dt in ('2020-11-27','2020-11-28');
insert into t1 values (1, "2020-11-25");
insert into t1 values (2, "2020-11-26");
insert into t1 values (3, "2020-11-27");
insert into t1 values (4, "2020-11-28");
select id from t1 where dt in ('2020-11-27','2020-11-28') order by id;
select id from t1 where dt in (20201127,'2020-11-28') order by id;
select id from t1 where dt in (20201127,20201128) order by id;
select id from t1 where dt in (20201127,20201128,null) order by id;
select id from t1 where dt in ('2020-11-26','2020-11-25','2020-11-28') order by id;
select id from t1 where dt in ('2020-11-26','wrong','2020-11-28') order by id;
create table t2 (a int) partition by range columns(a) (
		partition p0 values less than (0),
		partition p1 values less than (10),
		partition p2 values less than (20));
insert into t2 values (-1), (1), (11), (null);
select a from t2 where a in (-1, 1) order by a;
select a from t2 where a in (1, 11, null) order by a;
explain format='brief' select a from t2 where a in (-1, 1);
create table t3 (a varchar(10)) partition by range columns(a) (
		partition p0 values less than ("aaa"),
		partition p1 values less than ("bbb"),
		partition p2 values less than ("ccc"));
explain format='brief' select a from t3 where a in ('aaa', 'aab');
explain format='brief' select a from t3 where a in ('aaa', 'bu');


# TestRangeColumnPartitionPruningForInString
drop database if exists test_range_col_in_string;
create database test_range_col_in_string;
use test_range_col_in_string;
set names utf8mb4 collate utf8mb4_bin;
set @@session.tidb_partition_prune_mode='static';
create table t (a varchar(255) charset utf8mb4 collate utf8mb4_bin) partition by range columns(a)( partition pNull values less than (""),partition pAAAA values less than ("AAAA"),partition pCCC values less than ("CCC"),partition pShrimpsandwich values less than ("R√§ksm√∂rg√•s"),partition paaa values less than ("aaa"),partition pSushi values less than ("üç£üç£üç£"),partition pMax values less than (MAXVALUE));
insert into t values (NULL), ("a"), ("R√§kmacka"), ("üç£ is life"), ("üç∫ after work?"), ("üç∫üç∫üç∫üç∫üç∫ for oktoberfest"),("AA"),("aa"),("AAA"),("aaa");
set @@tidb_partition_prune_mode = 'dynamic';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a = 'aa';
--sorted_result
select * from t where a = 'aa';
explain format = 'brief' select * from t where a = 'aa' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'aa' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a collate utf8mb4_general_ci = 'aa';
--sorted_result
select * from t where a collate utf8mb4_general_ci = 'aa';
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AAA', 'aa');
--sorted_result
select * from t where a in ('AAA', 'aa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
explain format = 'brief' select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
--sorted_result
select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
set @@tidb_partition_prune_mode = 'static';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a = 'aa';
--sorted_result
select * from t where a = 'aa';
explain format = 'brief' select * from t where a = 'aa' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'aa' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a collate utf8mb4_general_ci = 'aa';
--sorted_result
select * from t where a collate utf8mb4_general_ci = 'aa';
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AAA', 'aa');
--sorted_result
select * from t where a in ('AAA', 'aa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
explain format = 'brief' select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
--sorted_result
select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
set names utf8mb4 collate utf8mb4_general_ci;
set @@tidb_partition_prune_mode = 'dynamic';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a = 'aa';
--sorted_result
select * from t where a = 'aa';
explain format = 'brief' select * from t where a = 'aa' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'aa' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a collate utf8mb4_general_ci = 'aa';
--sorted_result
select * from t where a collate utf8mb4_general_ci = 'aa';
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AAA', 'aa');
--sorted_result
select * from t where a in ('AAA', 'aa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
explain format = 'brief' select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
--sorted_result
select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
set @@tidb_partition_prune_mode = 'static';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a = 'aa';
--sorted_result
select * from t where a = 'aa';
explain format = 'brief' select * from t where a = 'aa' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'aa' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a collate utf8mb4_general_ci = 'aa';
--sorted_result
select * from t where a collate utf8mb4_general_ci = 'aa';
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AAA', 'aa');
--sorted_result
select * from t where a in ('AAA', 'aa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
explain format = 'brief' select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
--sorted_result
select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
set names utf8mb4 collate utf8mb4_unicode_ci;
set @@tidb_partition_prune_mode = 'dynamic';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a = 'aa';
--sorted_result
select * from t where a = 'aa';
explain format = 'brief' select * from t where a = 'aa' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'aa' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a collate utf8mb4_general_ci = 'aa';
--sorted_result
select * from t where a collate utf8mb4_general_ci = 'aa';
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AAA', 'aa');
--sorted_result
select * from t where a in ('AAA', 'aa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
explain format = 'brief' select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
--sorted_result
select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
set @@tidb_partition_prune_mode = 'static';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a = 'aa';
--sorted_result
select * from t where a = 'aa';
explain format = 'brief' select * from t where a = 'aa' collate utf8mb4_general_ci;
--sorted_result
select * from t where a = 'aa' collate utf8mb4_general_ci;
explain format = 'brief' select * from t where a collate utf8mb4_general_ci = 'aa';
--sorted_result
select * from t where a collate utf8mb4_general_ci = 'aa';
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AAA', 'aa');
--sorted_result
select * from t where a in ('AAA', 'aa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_general_ci, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_general_ci);
explain format = 'brief' select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
--sorted_result
select * from t where a collate utf8mb4_general_ci in ('AAA', 'aa');
drop table t;
create table t (a varchar(255) charset utf8mb4 collate utf8mb4_general_ci) partition by range columns(a)( partition pNull values less than (""),partition paaa values less than ("aaa"),partition pAAAA values less than ("AAAA"),partition pCCC values less than ("CCC"),partition pShrimpsandwich values less than ("R√§ksm√∂rg√•s"),partition pSushi values less than ("üç£üç£üç£"),partition pMax values less than (MAXVALUE));
insert into t values (NULL), ("a"), ("R√§kmacka"), ("üç£ is life"), ("üç∫ after work?"), ("üç∫üç∫üç∫üç∫üç∫ for oktoberfest"),("AA"),("aa"),("AAA"),("aaa");
set names utf8mb4 collate utf8mb4_bin;
set @@tidb_partition_prune_mode = 'dynamic';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AAA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AAA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AA', 'aaa');
--sorted_result
select * from t where a in ('AA', 'aaa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
set @@tidb_partition_prune_mode = 'static';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AAA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AAA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AA', 'aaa');
--sorted_result
select * from t where a in ('AA', 'aaa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
set names utf8mb4 collate utf8mb4_general_ci;
set @@tidb_partition_prune_mode = 'dynamic';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AAA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AAA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AA', 'aaa');
--sorted_result
select * from t where a in ('AA', 'aaa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
set @@tidb_partition_prune_mode = 'static';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AAA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AAA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AA', 'aaa');
--sorted_result
select * from t where a in ('AA', 'aaa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
set names utf8mb4 collate utf8mb4_unicode_ci;
set @@tidb_partition_prune_mode = 'dynamic';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AAA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AAA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AA', 'aaa');
--sorted_result
select * from t where a in ('AA', 'aaa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
set @@tidb_partition_prune_mode = 'static';
explain format = 'brief' select * from t where a IS NULL;
--sorted_result
select * from t where a IS NULL;
explain format = 'brief' select * from t where a = 'AA';
--sorted_result
select * from t where a = 'AA';
explain format = 'brief' select * from t where a = 'AA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AAA';
--sorted_result
select * from t where a = 'AAA';
explain format = 'brief' select * from t where a = 'AAA' collate utf8mb4_bin;
--sorted_result
select * from t where a = 'AAA' collate utf8mb4_bin;
explain format = 'brief' select * from t where a = 'AB';
--sorted_result
select * from t where a = 'AB';
explain format = 'brief' select * from t where a = 'aB';
--sorted_result
select * from t where a = 'aB';
explain format = 'brief' select * from t where a = 'üç£';
--sorted_result
select * from t where a = 'üç£';
explain format = 'brief' select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
--sorted_result
select * from t where a in ('üç£ is life', "R√§kmacka", "üç∫üç∫üç∫üç∫  after work?");
explain format = 'brief' select * from t where a in ('AA', 'aaa');
--sorted_result
select * from t where a in ('AA', 'aaa');
explain format = 'brief' select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
--sorted_result
select * from t where a in ('AAA' collate utf8mb4_bin, 'aa');
explain format = 'brief' select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);
--sorted_result
select * from t where a in ('AAA', 'aa' collate utf8mb4_bin);


# TestListColumnsPartitionPrunerRandom
drop database if exists test_partition;
create database test_partition;
use test_partition;
create table t1 (id int, a int, b int ) partition by list columns (b, id, a) (partition p0 values in ((1,0,2),(2,0,2),(0,1,0),(1,1,0),(2,1,0),(0,1,1),(0,1,2),(0,2,0),(1,2,0)),partition p1 values in ((1,0,1),(0,0,2),(2,1,1),(2,1,2),(2,2,1),(1,2,2),(2,2,2)),partition p2 values in ((0,0,0),(1,0,0),(2,0,0),(0,0,1),(2,0,1),(1,1,1),(1,1,2),(2,2,0),(0,2,1),(1,2,1),(0,2,2)));
# TestListColumnsPartitionPrunerRandom
drop database if exists test_partition_1;
create database test_partition_1;
use test_partition_1;
create table t1 (id int, a int, b int);
insert into t1 (b,id,a) values (1,0,2),(2,0,2),(0,1,0),(1,1,0),(2,1,0),(0,1,1),(0,1,2),(0,2,0),(1,2,0);
insert into t1 (b,id,a) values (1,0,2),(2,0,2),(0,1,0),(1,1,0),(2,1,0),(0,1,1),(0,1,2),(0,2,0),(1,2,0);
--sorted_result
select * from t1 order by id,a,b;
--sorted_result
select * from t1 order by id,a,b;
insert into t1 (b,id,a) values (1,0,1),(0,0,2),(2,1,1),(2,1,2),(2,2,1),(1,2,2),(2,2,2);
insert into t1 (b,id,a) values (1,0,1),(0,0,2),(2,1,1),(2,1,2),(2,2,1),(1,2,2),(2,2,2);
--sorted_result
select * from t1 order by id,a,b;
--sorted_result
select * from t1 order by id,a,b;
insert into t1 (b,id,a) values (0,0,0),(1,0,0),(2,0,0),(0,0,1),(2,0,1),(1,1,1),(1,1,2),(2,2,0),(0,2,1),(1,2,1),(0,2,2);
insert into t1 (b,id,a) values (0,0,0),(1,0,0),(2,0,0),(0,0,1),(2,0,1),(1,1,1),(1,1,2),(2,2,0),(0,2,1),(1,2,1),(0,2,2);
--sorted_result
select * from t1 order by id,a,b;
--sorted_result
select * from t1 order by id,a,b;
--sorted_result
select * from t1 where id = 0 order by id,a,b;
--sorted_result
select * from t1 where id = 0 order by id,a,b;
--sorted_result
select * from t1 where a = 0 order by id,a,b;
--sorted_result
select * from t1 where a = 0 order by id,a,b;
--sorted_result
select * from t1 where b = 0 order by id,a,b;
--sorted_result
select * from t1 where b = 0 order by id,a,b;
--sorted_result
select * from t1 where id = 1 order by id,a,b;
--sorted_result
select * from t1 where id = 1 order by id,a,b;
--sorted_result
select * from t1 where a = 1 order by id,a,b;
--sorted_result
select * from t1 where a = 1 order by id,a,b;
--sorted_result
select * from t1 where b = 1 order by id,a,b;
--sorted_result
select * from t1 where b = 1 order by id,a,b;
--sorted_result
select * from t1 where id = 2 order by id,a,b;
--sorted_result
select * from t1 where id = 2 order by id,a,b;
--sorted_result
select * from t1 where a = 2 order by id,a,b;
--sorted_result
select * from t1 where a = 2 order by id,a,b;
--sorted_result
select * from t1 where b = 2 order by id,a,b;
--sorted_result
select * from t1 where b = 2 order by id,a,b;
--sorted_result
select * from t1 where id = 3 order by id,a,b;
--sorted_result
select * from t1 where id = 3 order by id,a,b;
--sorted_result
select * from t1 where a = 3 order by id,a,b;
--sorted_result
select * from t1 where a = 3 order by id,a,b;
--sorted_result
select * from t1 where b = 3 order by id,a,b;
--sorted_result
select * from t1 where b = 3 order by id,a,b;
--sorted_result
select * from t1 where id = 4 order by id,a,b;
--sorted_result
select * from t1 where id = 4 order by id,a,b;
--sorted_result
select * from t1 where a = 4 order by id,a,b;
--sorted_result
select * from t1 where a = 4 order by id,a,b;
--sorted_result
select * from t1 where b = 4 order by id,a,b;
--sorted_result
select * from t1 where b = 4 order by id,a,b;
--sorted_result
select * from t1 where id = 5 order by id,a,b;
--sorted_result
select * from t1 where id = 5 order by id,a,b;
--sorted_result
select * from t1 where a = 5 order by id,a,b;
--sorted_result
select * from t1 where a = 5 order by id,a,b;
--sorted_result
select * from t1 where b = 5 order by id,a,b;
--sorted_result
select * from t1 where b = 5 order by id,a,b;
--sorted_result
select * from t1 where id = 6 order by id,a,b;
--sorted_result
select * from t1 where id = 6 order by id,a,b;
--sorted_result
select * from t1 where a = 6 order by id,a,b;
--sorted_result
select * from t1 where a = 6 order by id,a,b;
--sorted_result
select * from t1 where b = 6 order by id,a,b;
--sorted_result
select * from t1 where b = 6 order by id,a,b;
--sorted_result
select * from t1 where id = 7 order by id,a,b;
--sorted_result
select * from t1 where id = 7 order by id,a,b;
--sorted_result
select * from t1 where a = 7 order by id,a,b;
--sorted_result
select * from t1 where a = 7 order by id,a,b;
--sorted_result
select * from t1 where b = 7 order by id,a,b;
--sorted_result
select * from t1 where b = 7 order by id,a,b;
--sorted_result
select * from t1 where id = 8 order by id,a,b;
--sorted_result
select * from t1 where id = 8 order by id,a,b;
--sorted_result
select * from t1 where a = 8 order by id,a,b;
--sorted_result
select * from t1 where a = 8 order by id,a,b;
--sorted_result
select * from t1 where b = 8 order by id,a,b;
--sorted_result
select * from t1 where b = 8 order by id,a,b;
--sorted_result
select * from t1 where id = 9 order by id,a,b;
--sorted_result
select * from t1 where id = 9 order by id,a,b;
--sorted_result
select * from t1 where a = 9 order by id,a,b;
--sorted_result
select * from t1 where a = 9 order by id,a,b;
--sorted_result
select * from t1 where b = 9 order by id,a,b;
--sorted_result
select * from t1 where b = 9 order by id,a,b;
--sorted_result
select * from t1 where id = 10 order by id,a,b;
--sorted_result
select * from t1 where id = 10 order by id,a,b;
--sorted_result
select * from t1 where a = 10 order by id,a,b;
--sorted_result
select * from t1 where a = 10 order by id,a,b;
--sorted_result
select * from t1 where b = 10 order by id,a,b;
--sorted_result
select * from t1 where b = 10 order by id,a,b;
--sorted_result
select * from t1 where  0 = a  or  4 = b  order by id,a,b;
--sorted_result
select * from t1 where  0 = a  or  4 = b  order by id,a,b;
--sorted_result
select * from t1 where  b in (3,4,3,1) and  b = 0  order by id,a,b;
--sorted_result
select * from t1 where  b in (3,4,3,1) and  b = 0  order by id,a,b;
--sorted_result
select * from t1 where  1 = b  and  id = 3  and  1 = id  and  b in (1,0,1,3,4,0,4,4) order by id,a,b;
--sorted_result
select * from t1 where  1 = b  and  id = 3  and  1 = id  and  b in (1,0,1,3,4,0,4,4) order by id,a,b;
--sorted_result
select * from t1 where  1 = b  and  id in (1,1,4,4,1,0,3) order by id,a,b;
--sorted_result
select * from t1 where  1 = b  and  id in (1,1,4,4,1,0,3) order by id,a,b;
--sorted_result
select * from t1 where  1 = b  and  b = 4  order by id,a,b;
--sorted_result
select * from t1 where  1 = b  and  b = 4  order by id,a,b;




# TestIssue22635
DROP TABLE IF EXISTS t1;

CREATE TABLE t1 (
  a int(11) DEFAULT NULL,
  b int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin
PARTITION BY HASH( a )
PARTITIONS 4;
SELECT (SELECT tt.a FROM t1 tt ORDER BY a ASC LIMIT 1) aa, COUNT(DISTINCT b) FROM t1 GROUP BY aa;
insert into t1 values (1, 1);
SELECT (SELECT tt.a FROM t1 tt ORDER BY a ASC LIMIT 1) aa, COUNT(DISTINCT b) FROM t1 GROUP BY aa;
insert into t1 values (2, 2), (2, 2);
SELECT (SELECT tt.a FROM t1 tt ORDER BY a ASC LIMIT 1) aa, COUNT(DISTINCT b) FROM t1 GROUP BY aa;
insert into t1 values (3, 3), (3, 3), (3, 3);
SELECT (SELECT tt.a FROM t1 tt ORDER BY a ASC LIMIT 1) aa, COUNT(DISTINCT b) FROM t1 GROUP BY aa;
insert into t1 values (4, 4), (4, 4), (4, 4), (4, 4);
SELECT (SELECT tt.a FROM t1 tt ORDER BY a DESC LIMIT 1) aa, COUNT(DISTINCT b) FROM t1 GROUP BY aa;


# TestIssue22898
DROP TABLE IF EXISTS test;
CREATE TABLE NT_RP3763 (COL1 TINYINT(8) SIGNED COMMENT "NUMERIC NO INDEX" DEFAULT 41,COL2 VARCHAR(20),COL3 DATETIME,COL4 BIGINT,COL5 FLOAT) PARTITION BY RANGE (COL1 * COL3) (PARTITION P0 VALUES LESS THAN (0),PARTITION P1 VALUES LESS THAN (10),PARTITION P2 VALUES LESS THAN (20),PARTITION P3 VALUES LESS THAN (30),PARTITION P4 VALUES LESS THAN (40),PARTITION P5 VALUES LESS THAN (50),PARTITION PMX VALUES LESS THAN MAXVALUE);
insert into NT_RP3763 (COL1,COL2,COL3,COL4,COL5) values(-82,"Â§êÈΩèÈÜïÁöÜÁ£πÊºãÁîìÂ¥òÊΩÆÂµôÁá∑Ê∏èËâÇÊúºÊ¥õÁÇ∑Èâ¢ÂÑùÈ±àËÇá","5748\-06\-26\ 20:48:49",-3133527360541070260,-2.624880003397658e+38);
insert into NT_RP3763 (COL1,COL2,COL3,COL4,COL5) values(48,"Á∞ñÈπ©Á≠àÂåπÁúúËµñÊ≥ΩÈ®àÁà∑Ë©µËµ∫Áé°Â©ô…ÜÈÉùÈÆôÂªõË≥ôÁñºËà¢","7228\-12\-13\ 02:59:54",-6181009269190017937,2.7731105531290494e+38);
--sorted_result
select * from `NT_RP3763` where `COL1` in (10, 48, -82);
--sorted_result
select * from `NT_RP3763` where `COL1` in (48);


# TestIssue23622
drop table if exists t2;
create table t2 (a int, b int) partition by range (a) (partition p0 values less than (0), partition p1 values less than (5));
insert into t2(a) values (-1), (1);
--sorted_result
select * from t2 where a > 10 or b is NULL order by a;


# Test22396
DROP TABLE IF EXISTS test;
CREATE TABLE test(a INT, b INT, PRIMARY KEY(a, b)) PARTITION BY RANGE (a + b) (PARTITION p0 VALUES LESS THAN (20),PARTITION p1 VALUES LESS THAN MAXVALUE);
INSERT INTO test(a, b) VALUES(1, 11),(2, 22),(3, 33),(10, 44),(9, 55);
--sorted_result
select * FROM test WHERE a = 1;
--sorted_result
select * FROM test WHERE b = 1;
--sorted_result
select * FROM test WHERE a = 1 AND b = 1;
--sorted_result
select * FROM test WHERE a + b = 2;


# TestIssue23608
set @@tidb_partition_prune_mode='static';
drop table if exists t1;
create table t1(a int) partition by hash (a) partitions 10;
insert into t1 values (1), (2), (12), (3), (11), (13);
--sorted_result
select * from t1 where a not between 2 and 2;
--sorted_result
select * from t1 where not (a < -20 or a > 20);
--sorted_result
select * from t1 where not (a > 0 and a < 10);
--sorted_result
select * from t1 where not (a < -20);
--sorted_result
select * from t1 where not (a > 20);
--sorted_result
select * from t1 where not (a = 1);
--sorted_result
select * from t1 where not (a != 1);
drop table if exists t2;

create table t2(a int)
partition by range (a) (
    partition p0 values less than (0),
    partition p1 values less than (10),
    partition p2 values less than (20)
);
explain format = 'brief' select * from t2 where not (a < 5);
set @@tidb_partition_prune_mode='dynamic';
drop table if exists t3;
create table t3(a int) partition by hash (a) partitions 10;
insert into t3 values (1), (2), (12), (3), (11), (13);
--sorted_result
select * from t3 where a not between 2 and 2;
--sorted_result
select * from t3 where not (a < -20 or a > 20);
--sorted_result
select * from t3 where not (a > 0 and a < 10);
--sorted_result
select * from t3 where not (a < -20);
--sorted_result
select * from t3 where not (a > 20);
--sorted_result
select * from t3 where not (a = 1);
--sorted_result
select * from t3 where not (a != 1);


# TestHashPartitionPruning
set @@tidb_partition_prune_mode='static';
DROP TABLE IF EXISTS t;
CREATE TABLE t (`COL1` int, `COL3` bigint) PARTITION BY HASH ((`COL1` * `COL3`))PARTITIONS 13;
--sorted_result
select * FROM t WHERE col3 =2659937067964964513 and col1 = 783367513002;
drop table if exists t;
CREATE TABLE `t` (`COL1` int NOT NULL DEFAULT '25' COMMENT 'NUMERIC PK',`COL3` bigint NOT NULL,PRIMARY KEY (`COL1`,`COL3`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin PARTITION BY HASH ((`COL1` * `COL3`))PARTITIONS 13;
insert into t(col1, col3) values(0, 3522101843073676459);
SELECT col1, COL3 FROM t WHERE COL1 IN (0,14158354938390,0) AND COL3 IN (3522101843073676459,-2846203247576845955,838395691793635638);


# TestIssue32815
set @@tidb_partition_prune_mode='dynamic';
DROP TABLE IF EXISTS t;
create table t (a int primary key, b int, key (b)) partition by hash(a) (partition P0, partition p1, partition P2);
insert into t values (1, 1),(2, 2),(3, 3);
explain select * from t where a IN (1, 2);
explain select * from t where a IN (1, 2, 1);


# TestIssue32007
create database Issue32007;
USE Issue32007;
create table t1 (a int, b tinyint, primary key (a)) partition by range (a) (partition p0 values less than (5),partition p1 values less than (20),partition p2 values less than (30),partition p3 values less than (40),partition p4 values less than MAXVALUE);
insert into t1 values (0, 0), (1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (10, 10), (11, 11), (12, 12), (13, 13), (14, 14), (15, 15), (20, 20), (21, 21), (22, 22), (23, 23), (24, 24), (25, 25), (30, 30), (31, 31), (32, 32), (33, 33), (34, 34), (35, 35), (36, 36), (40, 40), (50, 50), (80, 80), (90, 90), (100, 100);
create table t3 (a int, b mediumint, primary key (a));
insert into t3 values (0, 0), (1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10), (11, 11), (12, 12), (13, 13), (14, 14), (15, 15), (16, 16), (17, 17), (18, 18), (19, 19), (20, 20), (21, 21), (22, 22), (23, 23);
set @@tidb_partition_prune_mode='static';
--sorted_result
select * from t3 where t3.a <> ALL (select t1.a from t1 partition (p0)) order by t3.a;
set @@tidb_partition_prune_mode='dynamic';
--sorted_result
select * from t3 where t3.a <> ALL (select t1.a from t1 partition (p0)) order by t3.a;


# TestIssue33231
create database issue33231;
use issue33231;
set @@session.tidb_partition_prune_mode = 'dynamic';
create table t1 (c_int int, c_str varchar(40), primary key (c_int, c_str) clustered, key(c_int) ) partition by hash (c_int) partitions 4;
create table t2 like t1;
insert into t1 values(6, 'beautiful curran');
insert into t1 values(7, 'epic kalam');
insert into t1 values(7, 'affectionate curie');
insert into t2 values(6, 'vigorous rhodes');
insert into t2 values(7, 'sweet aryabhata');
--sorted_result
select /*+ INL_JOIN(t2) */ * from t1, t2 where t1.c_int = t2.c_int and t1.c_str <= t2.c_str and t2.c_int in (6, 7, 6);


# TestListDefaultPruning
create database ListDefaultPrune;
use ListDefaultPrune;
create table t (a int, b int) partition by list columns (a,b) (partition p1 values in ((1,1)), partition p2 values in ((2,2)), partition pDef default);
insert into t values (1,1),(2,2),(1,2),(2,1),(3,3),(2,3),(1,4);
analyze table t all columns;
--sorted_result
select * from t where a in (1,2) and b in (1,2);
--sorted_result
select * from t where a in (1,2) and b in (3,4);
explain format='brief' select * from t where a in (1,2) and b in (3,4);
--sorted_result
select * from t where a in (1,2) and b in (1,2);
explain format='brief' select * from t where a in (1,2) and b in (1,2);
--sorted_result
select * from t where a in (1) and b in (1);
explain format='brief' select * from t where a in (1) and b in (1);
--sorted_result
select * from t where a = 1 and b = 1;
explain format='brief' select * from t where a = 1 and b = 1;
drop table t;
create table t (a int, b int) partition by list columns (a,b) (partition p1 values in ((1,1), (1,2)), partition p2 values in ((2,2),(2,1)), partition pDef default);
insert into t values (1,1),(2,2),(1,2),(2,1),(3,3),(2,3),(1,4);
analyze table t all columns;
--sorted_result
select * from t where a in (1,2) and b in (1,2);
explain format='brief' select * from t where a in (1,2) and b in (1,2);
drop table t;
create table t (a int, b int) partition by list columns (a) (partition p1 values in (1), partition p2 values in (2), partition pDef default);
insert into t values (1,1),(2,2),(1,2),(2,1),(3,3),(2,3),(1,4);
analyze table t all columns;
--sorted_result
select * from t where a in (1,2);
explain format='brief' select * from t where a in (1,2);
--sorted_result
select * from t where a = 1;
explain format='brief' select * from t where a  = 1;


# TestIssue42273
create database issue42273;
use issue42273;
CREATE TABLE t(a tinyint unsigned,  b tinyint unsigned) PARTITION BY RANGE COLUMNS (a,b)(
			PARTITION p0 VALUES LESS THAN (10,255),
			PARTITION p1 VALUES LESS THAN (20,MAXVALUE),
			PARTITION p2 VALUES LESS THAN (30,255),
			PARTITION p3 VALUES LESS THAN (MAXVALUE, 0));
insert into t values(20, 30);
analyze table t all columns;
explain format='brief' select * from t where a = 20;
explain format='brief' select * from t where a > 10 and a <= 20;
--sorted_result
select * from t where a = 20;
--sorted_result
select * from t where a > 10 and a <= 20;
drop database issue42273;


# TestIssue43459
create database issue43459;
use issue43459;
set @@session.tidb_partition_prune_mode = 'dynamic';
CREATE TABLE test1 (ID varchar(50) NOT NULL,
		PARTITION_NO int(11) NOT NULL DEFAULT '0',
		CREATE_TIME datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
		PRIMARY KEY (ID,PARTITION_NO,CREATE_TIME),
		KEY index_partition_no (PARTITION_NO)
		) PARTITION BY RANGE COLUMNS(PARTITION_NO,CREATE_TIME)
		(PARTITION 2023p1 VALUES LESS THAN (200000,'2023-01-01 00:00:00'),
		PARTITION 2023p2 VALUES LESS THAN (300000,'2023-01-01 00:00:00')) ;
insert into test1 values("1", 200000, "2022-12-29 12:00:00"), ("2",200000,"2023-01-01");
analyze table test1;
explain select * from test1 where partition_no > 199999;
explain select * from test1 where partition_no = 200000;
explain select * from test1 where partition_no >= 200000;
explain select * from test1 where partition_no < 200000;
explain select * from test1 where partition_no <= 200000;
explain select * from test1 where partition_no > 200000;
--sorted_result
select * from test1 partition (2023p1);
--sorted_result
select * from test1 partition (2023p2);
--sorted_result
select * from test1;
--sorted_result
select * from test1 where partition_no = 200000;
--sorted_result
select * from test1 where partition_no >= 200000;
drop table test1;
CREATE TABLE test1 (ID varchar(50) NOT NULL,
		PARTITION_NO int(11) NOT NULL DEFAULT '0',
		CREATE_TIME date NOT NULL DEFAULT CURRENT_DATE,
		PRIMARY KEY (ID,PARTITION_NO,CREATE_TIME),
		KEY index_partition_no (PARTITION_NO)
		) PARTITION BY RANGE COLUMNS(PARTITION_NO,CREATE_TIME)
		(PARTITION 2023p1 VALUES LESS THAN (200000,'2023-01-01 00:00:00'),
		PARTITION 2023p2 VALUES LESS THAN (300000,'2023-01-01 00:00:00')) ;
insert into test1 values("1", 200000, "2022-12-29 12:00:00"), ("2",200000,"2023-01-01");
analyze table test1;
explain select * from test1 where partition_no > 199999;
explain select * from test1 where partition_no = 200000;
explain select * from test1 where partition_no >= 200000;
explain select * from test1 where partition_no < 200000;
explain select * from test1 where partition_no <= 200000;
explain select * from test1 where partition_no > 200000;
--sorted_result
select * from test1 partition (2023p1);
--sorted_result
select * from test1 partition (2023p2);
--sorted_result
select * from test1;
--sorted_result
select * from test1 where partition_no = 200000;
--sorted_result
select * from test1 where partition_no >= 200000;
drop database issue43459;


# TestIssue50082
use planner__core__partition_pruner;
drop table if exists t;
create table t(a bigint unsigned)
PARTITION BY RANGE (`a`)
(PARTITION `p0` VALUES LESS THAN (5086706),
 PARTITION `p1` VALUES LESS THAN (7268292),
 PARTITION `p2` VALUES LESS THAN (16545422),
 PARTITION `p3` VALUES LESS THAN (9223372036854775810));
desc select * from t where a BETWEEN -6895222 AND 3125507;
desc select * from t where a > 9223372036854775808;
desc select * from t where a in (-6895222, 3125507, 9223372036854775809);

drop table if exists t;
create table t(a bigint)
PARTITION BY RANGE (`a`)
(PARTITION `p0` VALUES LESS THAN (5086706),
 PARTITION `p1` VALUES LESS THAN (7268292),
 PARTITION `p2` VALUES LESS THAN (16545422),
 PARTITION `p3` VALUES LESS THAN (9223372036854775807));
desc select * from t where a BETWEEN -6895222 AND 3125507;
desc select * from t where a > 9223372036854775808;
desc select * from t where a in (-6895222, 3125507, 9223372036854775809);

# Issue62754

CREATE TABLE `t4365b15e` (
  `col_18` tinyblob DEFAULT NULL,
  `col_19` smallint unsigned NOT NULL DEFAULT '14683',
  `col_20` char(39) COLLATE utf8_bin DEFAULT '',
  `col_21` time NOT NULL DEFAULT '01:08:07',
  `col_22` char(153) COLLATE utf8_unicode_ci NOT NULL DEFAULT '-‰ªÇ',
  UNIQUE KEY `idx_11` (`col_22`,`col_21`) /*T![global_index] GLOBAL */,
  UNIQUE KEY `idx_12` (`col_22`) /*T![global_index] GLOBAL */
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci
PARTITION BY RANGE COLUMNS(`col_22`)
(PARTITION `p0` VALUES LESS THAN ('ËÖÖtDË†äKVÂêµdÂïós'),
 PARTITION `p1` VALUES LESS THAN (MAXVALUE));
INSERT INTO `t4365b15e` VALUES(x'4a5955476d',32987,'uQKDBD99zce','09:35:47','yÁòá=rË≥úËé∂)2gÂ£ÖTÊï§qÂ±â'),(x'4a5955476d',25115,'uQKDBD99zce','09:35:47','@j-yDA'),(x'406b6271',22117,'c^E@*ybYRTqNkAgTFC5','19:31:21','Á∂ëÈûó'),(x'2d5e',4433,'d8G_Ic3Y*!rom**','09:38:32','1g0È§™PcËØ°Y&4yÊßÑ(OuÁ®†9Âò™'),(x'69595e6467682b',48233,'nP)$V','14:32:31','ÂüºdRÈø±'),(x'6f5f2b5e7a3346235a64787954784975566f',57918,'o^8g*wCsmo@FBXmOS','09:35:45','È∞ªe=r+'),(x'4a5955476d',65016,'uQKDBD99zce','09:35:47','wÂ±Ç'),(x'6169262d4b243d792a4775',58947,'uQKDBD99zce','09:35:47','wqT8ÊìütÁç±Ip'),(x'6d6e6a40415e48395e423634',20706,'MMz1zdUDgztb@','22:11:26','rUN'),(x'4a517a6b3066716f426823',41270,'v67T4$LO7uy0','19:28:09','!Èû§ÈèàÈãé2pÊìõ)nX4QI'),(x'36697124377042514a2521516c232862',23768,'c~~J','00:39:02','m'),(x'4a5955476d',61509,'uQKDBD99zce','09:35:47','Èê©UQBbÁ±πJQ57NÈüßS‰ªÇFw'),(x'4d6f78586d6e4a68426e5e2d71',41755,'wICNk7+@HQ&j)&ojFL','20:10:51','0GIUbFË≥ï#B'),(x'475a2444684c4a41',24780,'cPIPfD9Pd','20:30:43','YO5(eÁß¨vÈºæBkÊâ£Á´∑6IÈü§$Zp'),(x'4a5955476d',51992,'uQKDBD99zce','09:35:47','N!SwEUsnÂ†∂IÈê±'),(x'4a5955476d',65535,'uQKDBD99zce','09:35:47','Z5NLÁïèÈñªËöµ-'),(x'7751514d',25824,'LO9TOd^CI_MtE7LR^z','22:42:19','@ÁùæÊéò~Âùícq(o6XÈàû'),(x'38423771215333455e2d3842566b7641',49763,'yCyNZ$M8Q','12:52:23','Âµå&)oW‰ΩûuËíß48Âó°8Â∏ΩTdRf*'),(x'4a5955476d',65217,'uQKDBD99zce','09:35:47','%qnr'),(x'4a5955476d',37678,'uQKDBD99zce','09:35:47','ÈôÇcÈöänÊù≠SÈ∂îÁì±p5');
CREATE TABLE `tf460485d` (
  `col_57` tinytext COLLATE utf8_unicode_ci DEFAULT NULL,
  `col_58` varchar(477) COLLATE utf8_general_ci NOT NULL DEFAULT 'Ë¶Ω',
  `col_59` tinyint unsigned NOT NULL,
  `col_60` tinyint(1) NOT NULL DEFAULT '0',
  `col_61` tinyint(1) NOT NULL,
  `col_62` date DEFAULT '2031-12-15',
  `col_63` smallint unsigned DEFAULT '28366',
  `col_64` varbinary(389) NOT NULL,
  UNIQUE KEY `idx_17` (`col_58`),
  PRIMARY KEY (`col_58`) /*T![clustered_index] NONCLUSTERED */ /*T![global_index] GLOBAL */,
  UNIQUE KEY `idx_19` (`col_58`,`col_59`,`col_61`) /*T![global_index] GLOBAL */,
  UNIQUE KEY `idx_20` (`col_58`,`col_63`,`col_61`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci
PARTITION BY RANGE COLUMNS(`col_58`)
(PARTITION `p0` VALUES LESS THAN ('$0WcÊ´ô'),
 PARTITION `p1` VALUES LESS THAN ('Ë•ëËí¢$Â†Ä$hKiV'),
 PARTITION `p2` VALUES LESS THAN (MAXVALUE));
INSERT INTO `tf460485d` VALUES('1','RÁçæ',127,1,0,'1999-06-26',NULL,x'6f416e515e4e'),('-9Wd+h9FNWgtZ','~x',82,0,0,'2035-10-28',NULL,x''),('=I','UtEvXÊÆÉhÁûâCpWOE',171,1,0,'1973-03-18',858,x'524228455f71'),('0ATpI@W+8uF','xqÁÉ±O',146,1,0,'1986-12-17',26667,x'76664d59257456233951366f506e'),('1','dTÂïõÈãåPeJhÂñÖAL',33,1,0,'2022-05-06',5881,x'296748734d6f7634525f655f26556a7161'),('1','YÊéøÈ∫∂ÁµäÁ£µÂ§¨$Ê•Ø%ÊÇí‰πüË¥íR',255,1,0,'2014-11-06',10258,x'6f6a2a624a414e445a686a32237a7a23536664'),('0ATpI@W+8uF','D7Xa',203,1,0,'1981-05-12',26055,x'695a45617445344c5a233872436d'),('1','-JwÁû≤80zÁÅßUsYËß±ËâµXÁ§ã',156,1,0,'2007-09-27',31907,x'6b74'),('9Zv(^6PEL5%r','cmÁóµeÁºìRÂ¥ª*ÈßåZ*TuM',175,0,1,'2031-10-08',32717,x'6f462d634f4b795e58454a423246646b356666'),('0ATpI@W+8uF','(3ÊîìiÁóàXDQË®±WLËñπFÈåì',119,0,1,'1981-02-19',56610,x'6c2163514c5026'),('cCfZwARDfmRnhT4V8D+','$4#YÂä©ÊÄîs',230,0,0,'2020-06-23',12937,x'5455554d744a5a75412a43365f41387a5456'),('s(O04','fQjXE#LÊ´òUOaËÜ∏',157,0,0,'2010-12-19',28999,x'26494a73216342313d344d514d'),('LR5^o$*2','Ë∑™ÁÜùËëå0OÂÜæÊπÇ~(D5Áä£Y@*',81,0,0,'2013-05-30',15558,x'7a78625e4c4f6b752d472854'),('6*Y$H62VB)','Ë•æX_Ê¢º‰πµ',25,0,1,'2024-03-29',40076,x'67576c505a21457a576b264f64523d5e4149'),('VH5P+UikL(','eÂù≤V',31,1,1,'2005-05-07',1799,x'785e'),('0ATpI@W+8uF','%yr',61,0,1,'1976-07-20',65535,x'2d6566576a'),('!hJ7J!C#','dËÆ¶Il8È¨èÊåª#RËúÉÈ°ß',241,1,0,'1975-08-22',46070,x'37665f6f4f6d797a3243'),('DEhuX+rH(Tqnww','PÊ∫ÉÊåã%T',224,1,0,'2006-04-13',60626,x'5e2a712a4c234479436b796a455274525459'),('~6','1HÁΩ•Ë©üËùÆ%n6',127,0,0,'2024-06-12',24793,x'3d3126474a5236284a'),('0ATpI@W+8uF','yyRÂØìÂçñ=Ê∑ôQ!',148,1,0,'1991-07-05',32767,x''),('0ATpI@W+8uF','Êæ™',105,0,0,'1981-02-15',NULL,x'5f406767'),('0ATpI@W+8uF','9È®ûGÁú°gMJP+v+ÈãúË•ëÈ≤ØI',171,1,1,'1993-06-26',47054,x'74466e576550'),('tZ@aRBI8&','%ÈÖ¨dVÈÅá5',81,0,0,'1975-09-16',48645,x'2366546f7573756b267832');
SELECT SUM(`t4365b15e`.`col_19`) AS `r0`, `tf460485d`.`col_60` FROM `tf460485d` JOIN `t4365b15e` ON `tf460485d`.`col_60`=`t4365b15e`.`col_22` GROUP BY `tf460485d`.`col_60` HAVING `tf460485d`.`col_60` IN (1);

